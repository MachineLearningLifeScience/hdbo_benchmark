{{ $data := .data }}

<div class="tab-pane {{ if .active }}active{{ end }}" id="{{ .id }}" role="tabpanel" aria-labelledby="{{ .id }}-tab">
    <table class="table table-hover border">
        <thead class="">
            <tr class="">
                {{ range index $data 0}}
                    <th scope="col" class="" data-sortable="true" data-sort-order="desc">&nbsp;{{ . | safeHTML }}</th>
                {{ end }}
            </tr>
        </thead>
        <tbody>
            {{ range after 1 $data }}
                <tr>
                    {{ range first 1 . }}
                        <th scope="row" class="font-monospace fw-bold">{{ . | safeHTML }}</th>
                    {{ end }}

                    {{ range after 1 . }}
                        <td>{{ . | safeHTML }}</td>
                    {{ end }}
                </tr>
            {{ end }}
        </tbody>
    </table>

    {{ if .exp_setup }}
        {{ $data:= .exp_setup }}
      <div class="alert alert-success" role="alert">
        <h5 class="alert-heading">
            {{- partial "assets/icon.html" (dict "icon" "fas fa-flask" "spacing" false) }}
            Experiment setup
        </h5>
        <!-- iterate through column-names in csv $data -->
        <ul class="">
            {{ range $index,$element := index $data 0}}
                <li class="">
                    {{ $element | safeHTML }}: {{ index (index $data 1) $index | safeHTML }}
                </li>
            {{ end }}
      </div>
    {{ end }}
</div>

<script src="{{ absURL "js/jquery-3.7.1.slim.min.js" }}"></script>
<script src="{{ absURL "js/bootstrap-table.min.js" }}"></script>

<script>
    function customSort(sortName, sortOrder, data) {
        var order = sortOrder === 'desc' ? -1 : 1
        data.sort(function (a, b) {
            var aa = +((a[sortName] + '').replace(/[^\d]/g, ''))
            var bb = +((b[sortName] + '').replace(/[^\d]/g, ''))
            if (aa < bb) {
                return order * -1
            }
            if (aa > bb) {
                return order
            }
            return 0
        })
    }
    $("#{{.id}} table").bootstrapTable({
        customSort: customSort,
    });
</script>

<style>
    th:first-child, td:first-child{
        position: sticky;
        left: 0px;
        z-index: 1;
    }
</style>
